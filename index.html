<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShareApp (Myanmar) - Your App Sharing Platform</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8b5cf6;
            --secondary-color: #06b6d4;
            --accent-color: #10b981;
        }
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            transition: all 0.4s ease;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            padding-bottom: 80px; /* Space for bottom menu */
        }
        
        .dark body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark .glass-effect {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .app-card {
            transition: all 0.3s ease;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        .app-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(139, 92, 246, 0.3);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .bottom-menu {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            z-index: 100;
            padding: 10px 0;
        }
        
        .dark .bottom-menu {
            background: rgba(15, 23, 42, 0.95);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 8px 0;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .menu-item.active {
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary-color);
        }
        
        .menu-item i {
            font-size: 20px;
            margin-bottom: 4px;
        }
        
        .menu-item span {
            font-size: 12px;
            font-weight: 500;
        }
        
        .category-chip {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 20px;
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary-color);
            font-size: 14px;
            font-weight: 500;
            margin: 4px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .category-chip.active {
            background: var(--primary-color);
            color: white;
        }
        
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
        }
        
        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .dark .setting-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .language-option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-radius: 12px;
            margin: 4px 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .language-option:hover {
            background: rgba(139, 92, 246, 0.1);
        }
        
        .language-option.active {
            background: var(--primary-color);
            color: white;
        }
        
        .flag-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 12px;
            object-fit: cover;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .dark .modal-content {
            background: #1e293b;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 12px;
            background: #f9fafb;
            transition: all 0.3s;
        }
        
        .dark .form-input {
            background: #374151;
            border-color: #4b5563;
            color: white;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #7c3aed;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }
        
        .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }
        
        .dark .btn-secondary {
            background: #4b5563;
            color: white;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 12px;
            color: white;
            z-index: 1000;
            animation: slideInRight 0.3s ease;
        }
        
        .notification.success {
            background: #10b981;
        }
        
        .notification.error {
            background: #ef4444;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-slate-900 text-gray-800 dark:text-gray-200 min-h-screen transition-colors duration-300">
    <!-- Loading Screen -->
    <div id="loading-screen" class="fixed inset-0 bg-white dark:bg-slate-900 z-50 flex flex-col items-center justify-center">
        <div class="relative">
            <div class="w-20 h-20 rounded-2xl gradient-bg flex items-center justify-center">
                <i class="fas fa-mobile-alt text-white text-2xl"></i>
            </div>
            <div class="mt-4 text-center">
                <h2 class="text-2xl font-bold gradient-text">ShareApp</h2>
                <p class="text-gray-500 dark:text-gray-400 mt-2">Loading your experience...</p>
            </div>
        </div>
        <div class="w-64 h-2 bg-gray-200 dark:bg-slate-700 rounded-full mt-8 overflow-hidden">
            <div class="h-full gradient-bg rounded-full loading-bar"></div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="max-w-lg mx-auto px-4 py-4 hidden">
        <!-- Dynamic content will be loaded here -->
    </div>

    <!-- Bottom Menu Bar -->
    <div class="bottom-menu">
        <div class="max-w-lg mx-auto px-4">
            <div class="grid grid-cols-4 gap-2">
                <div class="menu-item active" onclick="navigate('home')">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </div>
                <div class="menu-item" onclick="navigate('upload-app')">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>Upload App</span>
                </div>
                <div class="menu-item" onclick="navigate('profile')">
                    <i class="fas fa-user"></i>
                    <span>Profile</span>
                </div>
                <div class="menu-item" onclick="navigate('admin')">
                    <i class="fas fa-shield-alt"></i>
                    <span>Admin</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Configuration -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, query, where, onSnapshot, addDoc, doc, updateDoc, deleteDoc, getDocs, orderBy, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAUL74mqVCIY1MMclrRhdVbY_VyP4lgQpY",
            authDomain: "waiappstore.firebaseapp.com",
            projectId: "waiappstore",
            storageBucket: "waiappstore.firebasestorage.app",
            messagingSenderId: "161610339691",
            appId: "1:161610339691:web:ce59fafb6a21729030682e",
            measurementId: "G-HH95X102MG"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Global State
        const state = {
            currentUser: null,
            userProfile: null,
            approvedApps: [],
            pendingApps: [],
            userApps: [],
            currentView: 'home',
            selectedAppId: null,
            searchTerm: '',
            selectedCategory: 'all',
            isAdmin: false,
            isEditingMode: false,
            editingAppDocId: null,
            isDarkMode: localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches),
            language: localStorage.getItem('language') || 'myanmar',
            isLoading: true
        };

        // Language translations
        const translations = {
            myanmar: {
                appName: "ShareApp (Myanmar)",
                home: "ပင်မစာမျက်နှာ",
                explore: "အက်ပ်များရှာဖွေရန်",
                profile: "ကိုယ်ရေးအချက်အလက်",
                myApps: "ကျွန်ုပ်၏အက်ပ်များ",
                submitApp: "အက်ပ်တင်သွင်းရန်",
                login: "ဝင်ရောက်ရန်",
                logout: "ထွက်ရန်",
                welcome: "မင်္ဂလာပါ",
                searchPlaceholder: "အက်ပ်များကို ရှာဖွေပါ...",
                categories: "အမျိုးအစားများ",
                all: "အားလုံး",
                tools: "ကိရိယာများ",
                games: "ဂိမ်းများ",
                social: "လူမှုကွန်ရက်",
                video: "ဗီဒီယို",
                music: "ဂီတ",
                others: "အခြား",
                popularApps: "လူကြိုက်များသော အက်ပ်များ",
                newApps: "အက်ပ်အသစ်များ",
                version: "ဗားရှင်း",
                download: "ဒေါင်းလုတ်ဆွဲရန်",
                developer: "တီထွင်သူ",
                appDetails: "အက်ပ်အသေးစိတ်",
                screenshots: "စခရင်ရှော့များ",
                noAppsFound: "အက်ပ်များ မတွေ့ပါ",
                resetFilters: "စစ်ထုတ်မှုများ ပြန်လည်သတ်မှတ်ရန်",
                adminPanel: "Admin Panel",
                pendingApproval: "ခွင့်ပြုချက်စောင့်ဆိုင်းနေသည်",
                approve: "ခွင့်ပြုရန်",
                reject: "ပယ်ချရန်",
                edit: "ပြင်ဆင်ရန်",
                delete: "ဖျက်ရန်",
                name: "အမည်",
                email: "အီးမေးလ်",
                password: "စကားဝှက်",
                confirmPassword: "စကားဝှက်အတည်ပြုရန်",
                createAccount: "အကောင့်အသစ်ဖွင့်ရန်",
                alreadyHaveAccount: "အကောင့်ရှိပြီးသားလား?",
                dontHaveAccount: "အကောင့်မရှိသေးဘူးလား?",
                signUp: "အကောင့်ဖွင့်ရန်",
                settings: "ဆက်တင်များ",
                darkMode: "အမှောင်မျက်နှာပြင်",
                language: "ဘာသာစကား",
                myanmar: "မြန်မာ",
                english: "အင်္ဂလိပ်",
                thai: "ထိုင်း",
                india: "အိန္ဒိယ",
                china: "တရုတ်",
                korea: "ကိုရီးယား",
                japan: "ဂျပန်",
                save: "သိမ်းဆည်းရန်",
                cancel: "မလုပ်တော့ပါ",
                submit: "တင်သွင်းရန်",
                appName: "အက်ပ်အမည်",
                appIcon: "အက်ပ်အိုင်ကွန်",
                appCategory: "အက်ပ်အမျိုးအစား",
                appVersion: "အက်ပ်ဗားရှင်း",
                appSize: "အက်ပ်အရွယ်အစား",
                appDeveloper: "အက်ပ်တီထွင်သူ",
                apkUrl: "APK လင့်ခ်",
                screenshotUrls: "စခရင်ရှော့လင့်ခ်များ",
                description: "ရည်ရွယ်ချက်",
                submitSuccess: "အက်ပ်အောင်မြင်စွာတင်သွင်းပြီးပါပြီ",
                submitError: "အက်ပ်တင်သွင်းရာတွင်အမှားတစ်ခုရှိနေပါသည်",
                loginSuccess: "အောင်မြင်စွာဝင်ရောက်ပြီးပါပြီ",
                loginError: "ဝင်ရောက်ရာတွင်အမှားတစ်ခုရှိနေပါသည်",
                registerSuccess: "အကောင့်အောင်မြင်စွာဖွင့်ပြီးပါပြီ",
                registerError: "အကောင့်ဖွင့်ရာတွင်အမှားတစ်ခုရှိနေပါသည်",
                contactUs: "ဆက်သွယ်ရန်",
                uploadApp: "အက်ပ်တင်ရန်",
                adminDescription: "Admin အနေနဲ့ အက်ပ်များကို စီမံခန့်ခွဲနိုင်ပါသည်",
                pendingApps: "စောင့်ဆိုင်းနေသော အက်ပ်များ",
                approvedApps: "အတည်ပြုပြီးသား အက်ပ်များ",
                noPendingApps: "စောင့်ဆိုင်းနေသော အက်ပ်များ မရှိပါ",
                noApprovedApps: "အတည်ပြုပြီးသား အက်ပ်များ မရှိပါ",
                appDeleted: "အက်ပ်ကို ဖျက်ပြီးပါပြီ",
                appApproved: "အက်ပ်ကို အတည်ပြုပြီးပါပြီ",
                loginToUpload: "အက်ပ်တင်ရန် အကောင့်ဝင်ရန်လိုအပ်ပါသည်",
                downloadLinks: "ဒေါင်းလုတ်လင့်ခ်များ"
            },
            english: {
                appName: "ShareApp (Myanmar)",
                home: "Home",
                explore: "Explore Apps",
                profile: "Profile",
                myApps: "My Apps",
                submitApp: "Submit App",
                login: "Login",
                logout: "Logout",
                welcome: "Welcome",
                searchPlaceholder: "Search for apps...",
                categories: "Categories",
                all: "All",
                tools: "Tools",
                games: "Games",
                social: "Social",
                video: "Video",
                music: "Music",
                others: "Others",
                popularApps: "Popular Apps",
                newApps: "New Apps",
                version: "Version",
                download: "Download",
                developer: "Developer",
                appDetails: "App Details",
                screenshots: "Screenshots",
                noAppsFound: "No apps found",
                resetFilters: "Reset Filters",
                adminPanel: "Admin Panel",
                pendingApproval: "Pending Approval",
                approve: "Approve",
                reject: "Reject",
                edit: "Edit",
                delete: "Delete",
                name: "Name",
                email: "Email",
                password: "Password",
                confirmPassword: "Confirm Password",
                createAccount: "Create Account",
                alreadyHaveAccount: "Already have an account?",
                dontHaveAccount: "Don't have an account?",
                signUp: "Sign Up",
                settings: "Settings",
                darkMode: "Dark Mode",
                language: "Language",
                myanmar: "Myanmar",
                english: "English",
                thai: "Thai",
                india: "India",
                china: "China",
                korea: "Korea",
                japan: "Japan",
                save: "Save",
                cancel: "Cancel",
                submit: "Submit",
                appName: "App Name",
                appIcon: "App Icon",
                appCategory: "App Category",
                appVersion: "App Version",
                appSize: "App Size",
                appDeveloper: "App Developer",
                apkUrl: "APK URL",
                screenshotUrls: "Screenshot URLs",
                description: "Description",
                submitSuccess: "App submitted successfully",
                submitError: "Error submitting app",
                loginSuccess: "Login successful",
                loginError: "Error logging in",
                registerSuccess: "Registration successful",
                registerError: "Error registering",
                contactUs: "Contact Us",
                uploadApp: "Upload App",
                adminDescription: "As an admin, you can manage apps",
                pendingApps: "Pending Apps",
                approvedApps: "Approved Apps",
                noPendingApps: "No pending apps",
                noApprovedApps: "No approved apps",
                appDeleted: "App deleted successfully",
                appApproved: "App approved successfully",
                loginToUpload: "Login required to upload apps",
                downloadLinks: "Download Links"
            }
        };

        // DOM Elements
        const APP_CONTAINER = document.getElementById('app-container');
        const LOADING_SCREEN = document.getElementById('loading-screen');

        // Initialize the app
        function initApp() {
            // Set up auth state listener
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    state.currentUser = user;
                    // Get user profile from Firestore
                    try {
                        const userDoc = await getDoc(doc(db, 'users', user.uid));
                        if (userDoc.exists()) {
                            state.userProfile = userDoc.data();
                        } else {
                            // Create a new user profile
                            state.userProfile = {
                                uid: user.uid,
                                displayName: user.displayName || 'User',
                                email: user.email,
                                photoURL: user.photoURL || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(user.displayName || 'User') + '&background=8b5cf6&color=fff',
                                language: state.language,
                                darkMode: state.isDarkMode,
                                createdAt: new Date().toISOString()
                            };
                            await setDoc(doc(db, 'users', user.uid), state.userProfile);
                        }
                        
                        // Update state with user preferences
                        state.language = state.userProfile.language || state.language;
                        state.isDarkMode = state.userProfile.darkMode !== undefined ? state.userProfile.darkMode : state.isDarkMode;
                        
                        // Check if user is admin
                        state.isAdmin = state.userProfile.email === 'admin@shareapp.com';
                    } catch (error) {
                        console.error("Error loading user profile:", error);
                    }
                } else {
                    state.currentUser = null;
                    state.userProfile = null;
                    state.userApps = [];
                    state.isAdmin = false;
                }
                
                // Apply user preferences
                applyUserPreferences();
                
                // Load all apps
                loadAllApps();
                
                // Show main app content
                setTimeout(() => {
                    LOADING_SCREEN.classList.add('hidden');
                    APP_CONTAINER.classList.remove('hidden');
                    render();
                }, 1000);
            });
        }

        // Apply user preferences (theme and language)
        function applyUserPreferences() {
            // Apply theme
            if (state.isDarkMode) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            
            // Apply language
            document.documentElement.lang = state.language === 'myanmar' ? 'my' : 'en';
        }

        // Load all apps from Firestore
        function loadAllApps() {
            const appsColRef = collection(db, 'apps');
            
            // Approved apps listener
            const approvedQuery = query(appsColRef, where("status", "==", "approved"));
            onSnapshot(approvedQuery, (snapshot) => {
                state.approvedApps = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                render();
            });
            
            // Pending apps listener (for admins)
            if (state.isAdmin) {
                const pendingQuery = query(appsColRef, where("status", "==", "pending"));
                onSnapshot(pendingQuery, (snapshot) => {
                    state.pendingApps = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    render();
                });
            }
        }

        // Translate function
        function t(key) {
            return translations[state.language][key] || key;
        }

        // Navigation function
        function navigate(view, id = null) {
            state.currentView = view;
            state.selectedAppId = id;
            state.isEditingMode = false;
            state.editingAppDocId = null;
            
            // Update active menu item
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            if (view === 'home') {
                document.querySelectorAll('.menu-item')[0].classList.add('active');
            } else if (view === 'upload-app') {
                document.querySelectorAll('.menu-item')[1].classList.add('active');
            } else if (view === 'profile') {
                document.querySelectorAll('.menu-item')[2].classList.add('active');
            } else if (view === 'admin') {
                document.querySelectorAll('.menu-item')[3].classList.add('active');
            }
            
            window.scrollTo(0, 0);
            render();
        }

        // Toggle dark mode
        function toggleDarkMode() {
            state.isDarkMode = !state.isDarkMode;
            applyUserPreferences();
            
            // Save to user profile if logged in
            if (state.currentUser) {
                updateDoc(doc(db, 'users', state.currentUser.uid), {
                    darkMode: state.isDarkMode
                });
            } else {
                localStorage.setItem('theme', state.isDarkMode ? 'dark' : 'light');
            }
            
            render();
        }

        // Change language
        function changeLanguage(lang) {
            state.language = lang;
            applyUserPreferences();
            
            // Save to user profile if logged in
            if (state.currentUser) {
                updateDoc(doc(db, 'users', state.currentUser.uid), {
                    language: state.language
                });
            } else {
                localStorage.setItem('language', state.language);
            }
            
            render();
        }

        // Handle search
        function handleSearch(term) {
            state.searchTerm = term;
            state.selectedCategory = 'all';
            render();
        }

        // Handle category filter
        function handleCategoryFilter(category) {
            state.selectedCategory = category;
            state.searchTerm = '';
            render();
        }

        // Reset filters
        function resetFilters() {
            state.searchTerm = '';
            state.selectedCategory = 'all';
            render();
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Handle user registration
        async function handleRegister(email, password, displayName) {
            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                await updateProfile(userCredential.user, {
                    displayName: displayName
                });
                
                // Create user profile in Firestore
                await setDoc(doc(db, 'users', userCredential.user.uid), {
                    uid: userCredential.user.uid,
                    displayName: displayName,
                    email: email,
                    photoURL: 'https://ui-avatars.com/api/?name=' + encodeURIComponent(displayName) + '&background=8b5cf6&color=fff',
                    language: state.language,
                    darkMode: state.isDarkMode,
                    createdAt: new Date().toISOString()
                });
                
                showNotification(t('registerSuccess'), 'success');
                return { success: true };
            } catch (error) {
                showNotification(t('registerError') + ': ' + error.message, 'error');
                return { success: false };
            }
        }

        // Handle user login
        async function handleLogin(email, password) {
            try {
                await signInWithEmailAndPassword(auth, email, password);
                showNotification(t('loginSuccess'), 'success');
                return { success: true };
            } catch (error) {
                showNotification(t('loginError') + ': ' + error.message, 'error');
                return { success: false };
            }
        }

        // Handle user logout
        async function handleLogout() {
            try {
                await signOut(auth);
                showNotification('Logged out successfully', 'success');
                navigate('home');
                return { success: true };
            } catch (error) {
                showNotification('Error logging out: ' + error.message, 'error');
                return { success: false };
            }
        }

        // Handle app submission
        async function handleAppSubmission(appData) {
            try {
                const appWithUserInfo = {
                    ...appData,
                    status: 'pending',
                    submitterId: state.currentUser.uid,
                    submitterName: state.userProfile.displayName,
                    submitterEmail: state.userProfile.email,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                await addDoc(collection(db, 'apps'), appWithUserInfo);
                showNotification(t('submitSuccess'), 'success');
                navigate('home');
                return { success: true };
            } catch (error) {
                showNotification(t('submitError') + ': ' + error.message, 'error');
                return { success: false };
            }
        }

        // Handle app approval
        async function approveApp(appId) {
            try {
                await updateDoc(doc(db, 'apps', appId), {
                    status: 'approved',
                    approvedAt: new Date().toISOString()
                });
                showNotification(t('appApproved'), 'success');
                return { success: true };
            } catch (error) {
                showNotification('Error approving app: ' + error.message, 'error');
                return { success: false };
            }
        }

        // Handle app deletion
        async function deleteApp(appId) {
            try {
                await deleteDoc(doc(db, 'apps', appId));
                showNotification(t('appDeleted'), 'success');
                return { success: true };
            } catch (error) {
                showNotification('Error deleting app: ' + error.message, 'error');
                return { success: false };
            }
        }

        // Render Header with Search and Categories
        function renderHeader() {
            const categories = [t('all'), t('tools'), t('games'), t('social'), t('video'), t('music'), t('others')];
            
            return `
                <header class="mb-6">
                    <!-- App Name -->
                    <div class="flex items-center justify-center mb-4">
                        <div class="w-12 h-12 rounded-2xl gradient-bg flex items-center justify-center mr-3">
                            <i class="fas fa-mobile-alt text-white text-xl"></i>
                        </div>
                        <h1 class="text-2xl font-bold gradient-text">${t('appName')}</h1>
                    </div>
                    
                    <!-- Search Box -->
                    <div class="mb-4">
                        <div class="relative">
                            <input
                                type="text"
                                id="search-input"
                                placeholder="${t('searchPlaceholder')}"
                                value="${state.searchTerm}"
                                oninput="handleSearch(this.value)"
                                class="w-full py-3 px-4 pl-12 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-2xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 shadow-sm"
                            >
                            <div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Categories -->
                    <div class="flex flex-wrap justify-center mb-2">
                        ${categories.map((cat, index) => `
                            <div class="category-chip ${state.selectedCategory === (index === 0 ? 'all' : cat.toLowerCase()) ? 'active' : ''}" 
                                 onclick="handleCategoryFilter('${index === 0 ? 'all' : cat.toLowerCase()}')">
                                ${cat}
                            </div>
                        `).join('')}
                    </div>
                </header>
            `;
        }

        // Render Home Page
        function renderHomePage() {
            const filteredApps = state.approvedApps
                .filter(app => state.selectedCategory === 'all' || app.category === state.selectedCategory)
                .filter(app => app.name.toLowerCase().includes(state.searchTerm.toLowerCase()));
            
            const popularApps = [...state.approvedApps].sort((a, b) => (b.downloadCount || 0) - (a.downloadCount || 0)).slice(0, 6);
            
            return `
                ${renderHeader()}
                
                <main>
                    <!-- Popular Apps Section -->
                    <section class="mb-8">
                        <h2 class="text-xl font-bold mb-4 gradient-text">${t('popularApps')}</h2>
                        
                        <div class="grid grid-cols-2 gap-4">
                            ${popularApps.length > 0 ? popularApps.map(app => `
                                <div class="app-card bg-white dark:bg-slate-800 rounded-2xl overflow-hidden p-4">
                                    <div class="flex flex-col items-center text-center">
                                        <img src="${app.icon}" alt="${app.name}" class="w-16 h-16 rounded-2xl object-cover shadow-md mb-3" onerror="this.src='https://via.placeholder.com/64/8b5cf6/ffffff?text=App'">
                                        <h3 class="font-bold text-sm mb-1 truncate w-full">${app.name}</h3>
                                        <p class="text-xs text-cyan-600 dark:text-cyan-400 mb-2">${app.category}</p>
                                        <div class="flex items-center text-xs text-gray-500 dark:text-gray-400 mb-3">
                                            <span class="mr-2"><i class="fas fa-download mr-1"></i> ${app.downloadCount || 0}</span>
                                            <span><i class="fas fa-star mr-1 text-yellow-500"></i> ${app.rating || 'N/A'}</span>
                                        </div>
                                        <button onclick="navigate('details', '${app.id}')" class="w-full py-2 bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-400 rounded-xl font-medium text-xs hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors duration-200">
                                            ${t('download')}
                                        </button>
                                    </div>
                                </div>
                            `).join('') : `
                                <div class="col-span-2 text-center py-8">
                                    <i class="fas fa-box-open text-3xl text-gray-400 mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400 text-sm">${t('noAppsFound')}</p>
                                </div>
                            `}
                        </div>
                    </section>
                    
                    <!-- All Apps Section -->
                    <section class="mb-8">
                        <h2 class="text-xl font-bold mb-4 gradient-text">${t('newApps')}</h2>
                        
                        <div class="space-y-4">
                            ${filteredApps.length > 0 ? filteredApps.map(app => `
                                <div class="app-card bg-white dark:bg-slate-800 rounded-2xl overflow-hidden p-4">
                                    <div class="flex items-center space-x-4">
                                        <img src="${app.icon}" alt="${app.name}" class="w-14 h-14 rounded-2xl object-cover shadow-md" onerror="this.src='https://via.placeholder.com/56/8b5cf6/ffffff?text=App'">
                                        <div class="flex-1">
                                            <h3 class="font-bold text-base mb-1">${app.name}</h3>
                                            <p class="text-sm text-cyan-600 dark:text-cyan-400 mb-1">${app.category}</p>
                                            <div class="flex items-center text-xs text-gray-500 dark:text-gray-400">
                                                <span class="mr-3">${t('version')}: ${app.version}</span>
                                                <span>${app.size}</span>
                                            </div>
                                        </div>
                                        <button onclick="navigate('details', '${app.id}')" class="py-2 px-4 bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-400 rounded-xl font-medium text-sm hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors duration-200">
                                            ${t('details')}
                                        </button>
                                    </div>
                                </div>
                            `).join('') : `
                                <div class="text-center py-8">
                                    <i class="fas fa-box-open text-3xl text-gray-400 mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">${t('noAppsFound')}</p>
                                    <button onclick="resetFilters()" class="mt-4 py-2 px-4 bg-purple-600 text-white rounded-xl font-medium hover:bg-purple-700 transition-colors duration-200">
                                        ${t('resetFilters')}
                                    </button>
                                </div>
                            `}
                        </div>
                    </section>
                </main>
            `;
        }

        // Render Upload App Page
        function renderUploadAppPage() {
            if (!state.currentUser) {
                return `
                    <div class="text-center py-12">
                        <i class="fas fa-exclamation-circle text-4xl text-yellow-500 mb-4"></i>
                        <h2 class="text-xl font-bold mb-2">${t('loginToUpload')}</h2>
                        <p class="text-gray-500 dark:text-gray-400 mb-6">${t('loginToUpload')}</p>
                        <button onclick="showLoginModal()" class="py-3 px-6 gradient-bg text-white rounded-2xl font-bold hover:shadow-lg transition-all duration-300">
                            ${t('login')}
                        </button>
                    </div>
                `;
            }
            
            return `
                ${renderHeader()}
                
                <main>
                    <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <h2 class="text-xl font-bold mb-6 gradient-text text-center">${t('uploadApp')}</h2>
                        
                        <form id="upload-form" class="space-y-4">
                            <div class="form-group">
                                <label class="form-label">${t('appName')}</label>
                                <input type="text" id="app-name" required class="form-input" placeholder="My Awesome App">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">${t('appDeveloper')}</label>
                                <input type="text" id="app-developer" required class="form-input" placeholder="John Doe">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">${t('appCategory')}</label>
                                <select id="app-category" required class="form-input">
                                    <option value="">${t('selectCategory')}</option>
                                    <option value="tools">${t('tools')}</option>
                                    <option value="games">${t('games')}</option>
                                    <option value="social">${t('social')}</option>
                                    <option value="video">${t('video')}</option>
                                    <option value="music">${t('music')}</option>
                                    <option value="others">${t('others')}</option>
                                </select>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">${t('appVersion')}</label>
                                    <input type="text" id="app-version" required class="form-input" placeholder="1.0.0">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">${t('appSize')}</label>
                                    <input type="text" id="app-size" required class="form-input" placeholder="15 MB">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">${t('appIcon')} URL</label>
                                <input type="url" id="app-icon" required class="form-input" placeholder="https://example.com/icon.png">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">${t('description')}</label>
                                <textarea id="app-description" rows="3" class="form-input" placeholder="${t('description')}"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">${t('downloadLinks')}</label>
                                <textarea id="app-download-links" rows="3" class="form-input" placeholder="https://example.com/download1.apk&#10;https://example.com/download2.apk&#10;https://example.com/download3.apk"></textarea>
                                <p class="text-sm text-gray-500 mt-1">${t('enterOneLinkPerLine')}</p>
                            </div>
                            
                            <button type="submit" class="btn btn-primary w-full">
                                ${t('submit')}
                            </button>
                        </form>
                    </div>
                </main>
                
                <script>
                    document.getElementById('upload-form').addEventListener('submit', async function(e) {
                        e.preventDefault();
                        
                        const appData = {
                            name: document.getElementById('app-name').value,
                            developer: document.getElementById('app-developer').value,
                            category: document.getElementById('app-category').value,
                            version: document.getElementById('app-version').value,
                            size: document.getElementById('app-size').value,
                            icon: document.getElementById('app-icon').value,
                            description: document.getElementById('app-description').value,
                            downloadLinks: document.getElementById('app-download-links').value.split('\\n').filter(link => link.trim())
                        };
                        
                        await handleAppSubmission(appData);
                    });
                </script>
            `;
        }

        // Render Profile Page
        function renderProfilePage() {
            return `
                ${renderHeader()}
                
                <main>
                    <!-- User Profile -->
                    <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg mb-6">
                        ${state.currentUser ? `
                            <div class="flex flex-col items-center text-center mb-6">
                                <img src="${state.userProfile.photoURL}" alt="Profile" class="profile-avatar mb-4">
                                <h2 class="text-xl font-bold">${state.userProfile.displayName}</h2>
                                <p class="text-gray-500 dark:text-gray-400">${state.userProfile.email}</p>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div class="bg-purple-50 dark:bg-purple-900/20 rounded-2xl p-4 text-center">
                                    <p class="text-2xl font-bold text-purple-600 dark:text-purple-400">${state.approvedApps.filter(app => app.submitterId === state.currentUser.uid).length}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${t('approved')}</p>
                                </div>
                                <div class="bg-cyan-50 dark:bg-cyan-900/20 rounded-2xl p-4 text-center">
                                    <p class="text-2xl font-bold text-cyan-600 dark:text-cyan-400">${state.pendingApps.filter(app => app.submitterId === state.currentUser.uid).length}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${t('pending')}</p>
                                </div>
                            </div>
                            
                            <button onclick="handleLogout()" class="btn btn-secondary w-full">
                                <i class="fas fa-sign-out-alt mr-2"></i> ${t('logout')}
                            </button>
                        ` : `
                            <div class="text-center py-8">
                                <div class="w-20 h-20 rounded-full bg-gray-200 dark:bg-slate-700 flex items-center justify-center mx-auto mb-4">
                                    <i class="fas fa-user text-gray-400 text-2xl"></i>
                                </div>
                                <h2 class="text-xl font-bold mb-2">${t('welcome')}</h2>
                                <p class="text-gray-500 dark:text-gray-400 mb-6">${t('loginToContinue')}</p>
                                <div class="space-y-4">
                                    <button onclick="showLoginModal()" class="btn btn-primary w-full">
                                        ${t('login')}
                                    </button>
                                    <button onclick="showRegisterModal()" class="btn btn-secondary w-full">
                                        ${t('signUp')}
                                    </button>
                                </div>
                            </div>
                        `}
                    </div>
                    
                    <!-- Settings -->
                    ${state.currentUser ? `
                        <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg mb-6">
                            <h2 class="text-xl font-bold mb-6 gradient-text">${t('settings')}</h2>
                            
                            <!-- Dark Mode Toggle -->
                            <div class="setting-item">
                                <div>
                                    <p class="font-medium">${t('darkMode')}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${state.isDarkMode ? t('on') : t('off')}</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" ${state.isDarkMode ? 'checked' : ''} onchange="toggleDarkMode()" class="sr-only peer">
                                    <div class="w-12 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-6 peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-0.5 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600"></div>
                                </label>
                            </div>
                            
                            <!-- Language Selection -->
                            <div class="setting-item">
                                <div>
                                    <p class="font-medium">${t('language')}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${t(state.language)}</p>
                                </div>
                                <button onclick="showLanguageModal()" class="btn btn-secondary">
                                    ${t('change')}
                                </button>
                            </div>
                        </div>
                    ` : ''}
                    
                    <!-- Contact Us -->
                    <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg text-center">
                        <h3 class="text-lg font-bold mb-2">${t('contactUs')}</h3>
                        <p class="text-gray-500 dark:text-gray-400 mb-4">ဆက်သွယ်ရန် Telegram လင့်ခ်</p>
                        <a href="https://t.me/appcreator24myanmar" target="_blank" class="inline-flex items-center btn btn-primary">
                            <i class="fab fa-telegram mr-2"></i> Telegram
                        </a>
                    </div>
                </main>
            `;
        }

        // Render Admin Page
        function renderAdminPage() {
            if (!state.isAdmin) {
                return `
                    <div class="text-center py-12">
                        <i class="fas fa-shield-alt text-4xl text-red-500 mb-4"></i>
                        <h2 class="text-xl font-bold mb-2">Admin Access Required</h2>
                        <p class="text-gray-500 dark:text-gray-400 mb-6">You need admin privileges to access this page</p>
                        <button onclick="navigate('home')" class="btn btn-primary">
                            ${t('home')}
                        </button>
                    </div>
                `;
            }
            
            return `
                ${renderHeader()}
                
                <main>
                    <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg mb-6">
                        <h2 class="text-xl font-bold mb-2 gradient-text">${t('adminPanel')}</h2>
                        <p class="text-gray-500 dark:text-gray-400 mb-6">${t('adminDescription')}</p>
                    </div>
                    
                    <!-- Pending Apps -->
                    <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg mb-6">
                        <h3 class="text-lg font-bold mb-4">${t('pendingApps')} (${state.pendingApps.length})</h3>
                        
                        ${state.pendingApps.length > 0 ? state.pendingApps.map(app => `
                            <div class="border border-gray-200 dark:border-slate-600 rounded-2xl p-4 mb-4">
                                <div class="flex items-center space-x-4 mb-3">
                                    <img src="${app.icon}" alt="${app.name}" class="w-12 h-12 rounded-2xl object-cover" onerror="this.src='https://via.placeholder.com/48/8b5cf6/ffffff?text=App'">
                                    <div class="flex-1">
                                        <h4 class="font-bold">${app.name}</h4>
                                        <p class="text-sm text-gray-500">${t('by')} ${app.submitterName}</p>
                                    </div>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="approveApp('${app.id}')" class="btn btn-primary flex-1">
                                        <i class="fas fa-check mr-2"></i> ${t('approve')}
                                    </button>
                                    <button onclick="deleteApp('${app.id}')" class="btn btn-secondary flex-1">
                                        <i class="fas fa-trash mr-2"></i> ${t('delete')}
                                    </button>
                                </div>
                            </div>
                        `).join('') : `
                            <p class="text-gray-500 dark:text-gray-400 text-center py-4">${t('noPendingApps')}</p>
                        `}
                    </div>
                    
                    <!-- Approved Apps -->
                    <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg">
                        <h3 class="text-lg font-bold mb-4">${t('approvedApps')} (${state.approvedApps.length})</h3>
                        
                        ${state.approvedApps.length > 0 ? state.approvedApps.map(app => `
                            <div class="border border-gray-200 dark:border-slate-600 rounded-2xl p-4 mb-4">
                                <div class="flex items-center space-x-4">
                                    <img src="${app.icon}" alt="${app.name}" class="w-12 h-12 rounded-2xl object-cover" onerror="this.src='https://via.placeholder.com/48/8b5cf6/ffffff?text=App'">
                                    <div class="flex-1">
                                        <h4 class="font-bold">${app.name}</h4>
                                        <p class="text-sm text-gray-500">${t('by')} ${app.developer}</p>
                                    </div>
                                    <button onclick="deleteApp('${app.id}')" class="btn btn-secondary">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('') : `
                            <p class="text-gray-500 dark:text-gray-400 text-center py-4">${t('noApprovedApps')}</p>
                        `}
                    </div>
                </main>
            `;
        }

        // Render Login Modal
        function renderLoginModal() {
            return `
                <div class="modal" id="login-modal">
                    <div class="modal-content">
                        <h2 class="text-xl font-bold mb-6 text-center">${t('login')}</h2>
                        <form id="login-form" class="space-y-4">
                            <div class="form-group">
                                <label class="form-label">${t('email')}</label>
                                <input type="email" id="login-email" required class="form-input" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">${t('password')}</label>
                                <input type="password" id="login-password" required class="form-input" placeholder="••••••••">
                            </div>
                            <button type="submit" class="btn btn-primary w-full">${t('login')}</button>
                        </form>
                        <p class="text-center mt-4">
                            ${t('dontHaveAccount')} 
                            <a href="javascript:void(0)" onclick="showRegisterModal()" class="text-purple-600 font-medium">${t('signUp')}</a>
                        </p>
                        <button onclick="document.getElementById('login-modal').remove()" class="btn btn-secondary w-full mt-4">${t('cancel')}</button>
                    </div>
                </div>
                
                <script>
                    document.getElementById('login-form').addEventListener('submit', async function(e) {
                        e.preventDefault();
                        const email = document.getElementById('login-email').value;
                        const password = document.getElementById('login-password').value;
                        
                        await handleLogin(email, password);
                        document.getElementById('login-modal').remove();
                    });
                </script>
            `;
        }

        // Render Register Modal
        function renderRegisterModal() {
            return `
                <div class="modal" id="register-modal">
                    <div class="modal-content">
                        <h2 class="text-xl font-bold mb-6 text-center">${t('signUp')}</h2>
                        <form id="register-form" class="space-y-4">
                            <div class="form-group">
                                <label class="form-label">${t('name')}</label>
                                <input type="text" id="register-name" required class="form-input" placeholder="Your Name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">${t('email')}</label>
                                <input type="email" id="register-email" required class="form-input" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">${t('password')}</label>
                                <input type="password" id="register-password" required class="form-input" placeholder="••••••••">
                            </div>
                            <button type="submit" class="btn btn-primary w-full">${t('signUp')}</button>
                        </form>
                        <p class="text-center mt-4">
                            ${t('alreadyHaveAccount')} 
                            <a href="javascript:void(0)" onclick="showLoginModal()" class="text-purple-600 font-medium">${t('login')}</a>
                        </p>
                        <button onclick="document.getElementById('register-modal').remove()" class="btn btn-secondary w-full mt-4">${t('cancel')}</button>
                    </div>
                </div>
                
                <script>
                    document.getElementById('register-form').addEventListener('submit', async function(e) {
                        e.preventDefault();
                        const name = document.getElementById('register-name').value;
                        const email = document.getElementById('register-email').value;
                        const password = document.getElementById('register-password').value;
                        
                        await handleRegister(email, password, name);
                        document.getElementById('register-modal').remove();
                    });
                </script>
            `;
        }

        // Render Language Modal
        function renderLanguageModal() {
            return `
                <div class="modal" id="language-modal">
                    <div class="modal-content">
                        <h3 class="text-xl font-bold mb-4">${t('selectLanguage')}</h3>
                        <div class="space-y-2">
                            ${['myanmar', 'english', 'thai', 'india', 'china', 'korea', 'japan'].map(lang => `
                                <div class="language-option ${state.language === lang ? 'active' : ''}" onclick="changeLanguage('${lang}'); document.getElementById('language-modal').remove()">
                                    <img src="https://flagcdn.com/w40/${getCountryCode(lang)}.png" class="flag-icon">
                                    <span>${t(lang)}</span>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="document.getElementById('language-modal').remove()" class="btn btn-secondary w-full mt-4">${t('cancel')}</button>
                    </div>
                </div>
            `;
        }

        // Main render function
        function render() {
            let content = '';
            
            switch (state.currentView) {
                case 'home':
                    content = renderHomePage();
                    break;
                case 'upload-app':
                    content = renderUploadAppPage();
                    break;
                case 'profile':
                    content = renderProfilePage();
                    break;
                case 'admin':
                    content = renderAdminPage();
                    break;
                default:
                    content = renderHomePage();
            }
            
            APP_CONTAINER.innerHTML = content;
        }

        // Modal functions
        function showLoginModal() {
            document.body.insertAdjacentHTML('beforeend', renderLoginModal());
        }

        function showRegisterModal() {
            document.body.insertAdjacentHTML('beforeend', renderRegisterModal());
        }

        function showLanguageModal() {
            document.body.insertAdjacentHTML('beforeend', renderLanguageModal());
        }

        function getCountryCode(lang) {
            const codes = {
                myanmar: 'mm',
                english: 'us',
                thai: 'th',
                india: 'in',
                china: 'cn',
                korea: 'kr',
                japan: 'jp'
            };
            return codes[lang] || 'us';
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);

        // Make functions globally available
        window.navigate = navigate;
        window.toggleDarkMode = toggleDarkMode;
        window.changeLanguage = changeLanguage;
        window.handleSearch = handleSearch;
        window.handleCategoryFilter = handleCategoryFilter;
        window.resetFilters = resetFilters;
        window.handleLogin = handleLogin;
        window.handleRegister = handleRegister;
        window.handleLogout = handleLogout;
        window.handleAppSubmission = handleAppSubmission;
        window.approveApp = approveApp;
        window.deleteApp = deleteApp;
        window.showLoginModal = showLoginModal;
        window.showRegisterModal = showRegisterModal;
        window.showLanguageModal = showLanguageModal;
        window.getCountryCode = getCountryCode;
    </script>
</body>
</html>
