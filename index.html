<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShareApp (Myanmar) - Your App Sharing Platform</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8b5cf6;
            --secondary-color: #06b6d4;
            --accent-color: #10b981;
        }
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            transition: all 0.4s ease;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
        }
        
        .dark body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark .glass-effect {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .app-card {
            transition: all 0.3s ease;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .app-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px -10px rgba(139, 92, 246, 0.3);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .language-flag {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 8px;
        }
        
        .floating-action-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            z-index: 100;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 30px rgba(139, 92, 246, 0.6);
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .skeleton-loader {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        .dark .skeleton-loader {
            background: linear-gradient(90deg, #334155 25%, #475569 50%, #334155 75%);
            background-size: 200% 100%;
        }
        
        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(139, 92, 246, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(139, 92, 246, 0);
            }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease forwards;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-slate-900 text-gray-800 dark:text-gray-200 min-h-screen transition-colors duration-300">
    <!-- Loading Screen -->
    <div id="loading-screen" class="fixed inset-0 bg-white dark:bg-slate-900 z-50 flex flex-col items-center justify-center">
        <div class="relative">
            <div class="w-20 h-20 rounded-2xl gradient-bg flex items-center justify-center pulse-animation">
                <i class="fas fa-mobile-alt text-white text-2xl"></i>
            </div>
            <div class="mt-4 text-center">
                <h2 class="text-2xl font-bold gradient-text">ShareApp</h2>
                <p class="text-gray-500 dark:text-gray-400 mt-2">Loading your experience...</p>
            </div>
        </div>
        <div class="w-64 h-2 bg-gray-200 dark:bg-slate-700 rounded-full mt-8 overflow-hidden">
            <div class="h-full gradient-bg rounded-full loading-bar"></div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="max-w-7xl mx-auto px-4 py-6 hidden">
        <!-- Dynamic content will be loaded here -->
    </div>

    <!-- Floating Action Button -->
    <div id="fab" class="floating-action-btn hidden">
        <i class="fas fa-plus"></i>
    </div>

    <!-- Firebase Configuration -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, query, where, onSnapshot, addDoc, doc, updateDoc, deleteDoc, getDocs, orderBy, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAUL74mqVCIY1MMclrRhdVbY_VyP4lgQpY",
            authDomain: "waiappstore.firebaseapp.com",
            projectId: "waiappstore",
            storageBucket: "waiappstore.firebasestorage.app",
            messagingSenderId: "161610339691",
            appId: "1:161610339691:web:ce59fafb6a21729030682e",
            measurementId: "G-HH95X102MG"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Global State
        const state = {
            currentUser: null,
            userProfile: null,
            approvedApps: [],
            pendingApps: [],
            userApps: [],
            currentView: 'home',
            selectedAppId: null,
            searchTerm: '',
            selectedCategory: 'all',
            isAdmin: false,
            isEditingMode: false,
            editingAppDocId: null,
            isDarkMode: localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches),
            language: localStorage.getItem('language') || 'myanmar',
            isLoading: true
        };

        // Language translations
        const translations = {
            myanmar: {
                appName: "ShareApp (Myanmar)",
                home: "ပင်မစာမျက်နှာ",
                explore: "အက်ပ်များရှာဖွေရန်",
                profile: "ကိုယ်ရေးအချက်အလက်",
                myApps: "ကျွန်ုပ်၏အက်ပ်များ",
                submitApp: "အက်ပ်တင်သွင်းရန်",
                login: "ဝင်ရောက်ရန်",
                logout: "ထွက်ရန်",
                welcome: "မင်္ဂလာပါ",
                searchPlaceholder: "အက်ပ်များကို ရှာဖွေပါ...",
                categories: "အမျိုးအစားများ",
                all: "အားလုံး",
                tools: "ကိရိယာများ",
                games: "ဂိမ်းများ",
                social: "လူမှုကွန်ရက်",
                video: "ဗီဒီယို",
                music: "ဂီတ",
                others: "အခြား",
                popularApps: "လူကြိုက်များသော အက်ပ်များ",
                newApps: "အက်ပ်အသစ်များ",
                version: "ဗားရှင်း",
                download: "ဒေါင်းလုတ်ဆွဲရန်",
                developer: "တီထွင်သူ",
                appDetails: "အက်ပ်အသေးစိတ်",
                screenshots: "စခရင်ရှော့များ",
                noAppsFound: "အက်ပ်များ မတွေ့ပါ",
                resetFilters: "စစ်ထုတ်မှုများ ပြန်လည်သတ်မှတ်ရန်",
                adminPanel: "Admin Panel",
                pendingApproval: "ခွင့်ပြုချက်စောင့်ဆိုင်းနေသည်",
                approve: "ခွင့်ပြုရန်",
                reject: "ပယ်ချရန်",
                edit: "ပြင်ဆင်ရန်",
                delete: "ဖျက်ရန်",
                name: "အမည်",
                email: "အီးမေးလ်",
                password: "စကားဝှက်",
                confirmPassword: "စကားဝှက်အတည်ပြုရန်",
                createAccount: "အကောင့်အသစ်ဖွင့်ရန်",
                alreadyHaveAccount: "အကောင့်ရှိပြီးသားလား?",
                dontHaveAccount: "အကောင့်မရှိသေးဘူးလား?",
                signUp: "အကောင့်ဖွင့်ရန်",
                settings: "ဆက်တင်များ",
                darkMode: "အမှောင်မျက်နှာပြင်",
                language: "ဘာသာစကား",
                myanmar: "မြန်မာ",
                english: "အင်္ဂလိပ်",
                thai: "ထိုင်း",
                india: "အိန္ဒိယ",
                china: "တရုတ်",
                korea: "ကိုရီးယား",
                japan: "ဂျပန်",
                save: "သိမ်းဆည်းရန်",
                cancel: "မလုပ်တော့ပါ",
                submit: "တင်သွင်းရန်",
                appName: "အက်ပ်အမည်",
                appIcon: "အက်ပ်အိုင်ကွန်",
                appCategory: "အက်ပ်အမျိုးအစား",
                appVersion: "အက်ပ်ဗားရှင်း",
                appSize: "အက်ပ်အရွယ်အစား",
                appDeveloper: "အက်ပ်တီထွင်သူ",
                apkUrl: "APK လင့်ခ်",
                screenshotUrls: "စခရင်ရှော့လင့်ခ်များ",
                description: "ဖော်ပြချက်",
                submitSuccess: "အက်ပ်အောင်မြင်စွာတင်သွင်းပြီးပါပြီ",
                submitError: "အက်ပ်တင်သွင်းရာတွင်အမှားတစ်ခုရှိနေပါသည်",
                loginSuccess: "အောင်မြင်စွာဝင်ရောက်ပြီးပါပြီ",
                loginError: "ဝင်ရောက်ရာတွင်အမှားတစ်ခုရှိနေပါသည်",
                registerSuccess: "အကောင့်အောင်မြင်စွာဖွင့်ပြီးပါပြီ",
                registerError: "အကောင့်ဖွင့်ရာတွင်အမှားတစ်ခုရှိနေပါသည်"
            },
            english: {
                appName: "ShareApp (Myanmar)",
                home: "Home",
                explore: "Explore Apps",
                profile: "Profile",
                myApps: "My Apps",
                submitApp: "Submit App",
                login: "Login",
                logout: "Logout",
                welcome: "Welcome",
                searchPlaceholder: "Search for apps...",
                categories: "Categories",
                all: "All",
                tools: "Tools",
                games: "Games",
                social: "Social",
                video: "Video",
                music: "Music",
                others: "Others",
                popularApps: "Popular Apps",
                newApps: "New Apps",
                version: "Version",
                download: "Download",
                developer: "Developer",
                appDetails: "App Details",
                screenshots: "Screenshots",
                noAppsFound: "No apps found",
                resetFilters: "Reset Filters",
                adminPanel: "Admin Panel",
                pendingApproval: "Pending Approval",
                approve: "Approve",
                reject: "Reject",
                edit: "Edit",
                delete: "Delete",
                name: "Name",
                email: "Email",
                password: "Password",
                confirmPassword: "Confirm Password",
                createAccount: "Create Account",
                alreadyHaveAccount: "Already have an account?",
                dontHaveAccount: "Don't have an account?",
                signUp: "Sign Up",
                settings: "Settings",
                darkMode: "Dark Mode",
                language: "Language",
                myanmar: "Myanmar",
                english: "English",
                thai: "Thai",
                india: "India",
                china: "China",
                korea: "Korea",
                japan: "Japan",
                save: "Save",
                cancel: "Cancel",
                submit: "Submit",
                appName: "App Name",
                appIcon: "App Icon",
                appCategory: "App Category",
                appVersion: "App Version",
                appSize: "App Size",
                appDeveloper: "App Developer",
                apkUrl: "APK URL",
                screenshotUrls: "Screenshot URLs",
                description: "Description",
                submitSuccess: "App submitted successfully",
                submitError: "Error submitting app",
                loginSuccess: "Login successful",
                loginError: "Error logging in",
                registerSuccess: "Registration successful",
                registerError: "Error registering"
            }
            // Other languages would follow the same pattern
        };

        // DOM Elements
        const APP_CONTAINER = document.getElementById('app-container');
        const LOADING_SCREEN = document.getElementById('loading-screen');
        const FAB = document.getElementById('fab');

        // Initialize the app
        function initApp() {
            // Set up auth state listener
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    state.currentUser = user;
                    // Get user profile from Firestore
                    const userDoc = await getDoc(doc(db, 'users', user.uid));
                    if (userDoc.exists()) {
                        state.userProfile = userDoc.data();
                    } else {
                        // Create a new user profile
                        state.userProfile = {
                            uid: user.uid,
                            displayName: user.displayName || 'User',
                            email: user.email,
                            photoURL: user.photoURL || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(user.displayName || 'User') + '&background=8b5cf6&color=fff',
                            language: state.language,
                            darkMode: state.isDarkMode,
                            createdAt: new Date().toISOString()
                        };
                        await setDoc(doc(db, 'users', user.uid), state.userProfile);
                    }
                    
                    // Update state with user preferences
                    state.language = state.userProfile.language || state.language;
                    state.isDarkMode = state.userProfile.darkMode !== undefined ? state.userProfile.darkMode : state.isDarkMode;
                    
                    // Apply user preferences
                    applyUserPreferences();
                    
                    // Check if user is admin
                    state.isAdmin = state.userProfile.role === 'admin';
                    
                    // Load user's apps
                    loadUserApps();
                } else {
                    state.currentUser = null;
                    state.userProfile = null;
                    state.userApps = [];
                    state.isAdmin = false;
                }
                
                // Load all apps
                loadAllApps();
                
                // Show main app content
                setTimeout(() => {
                    LOADING_SCREEN.classList.add('hidden');
                    APP_CONTAINER.classList.remove('hidden');
                    FAB.classList.remove('hidden');
                    render();
                }, 1000);
            });
        }

        // Apply user preferences (theme and language)
        function applyUserPreferences() {
            // Apply theme
            if (state.isDarkMode) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            
            // Apply language
            document.documentElement.lang = state.language === 'myanmar' ? 'my' : 'en';
        }

        // Load all apps from Firestore
        function loadAllApps() {
            const appsColRef = collection(db, 'apps');
            
            // Approved apps listener
            const approvedQuery = query(appsColRef, where("status", "==", "approved"));
            onSnapshot(approvedQuery, (snapshot) => {
                state.approvedApps = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                render();
            });
            
            // Pending apps listener (for admins)
            if (state.isAdmin) {
                const pendingQuery = query(appsColRef, where("status", "==", "pending"));
                onSnapshot(pendingQuery, (snapshot) => {
                    state.pendingApps = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    render();
                });
            }
        }

        // Load user's apps
        function loadUserApps() {
            if (!state.currentUser) return;
            
            const userAppsQuery = query(collection(db, 'apps'), where("submitterId", "==", state.currentUser.uid));
            onSnapshot(userAppsQuery, (snapshot) => {
                state.userApps = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                render();
            });
        }

        // Translate function
        function t(key) {
            return translations[state.language][key] || key;
        }

        // Navigation function
        function navigate(view, id = null) {
            state.currentView = view;
            state.selectedAppId = id;
            state.isEditingMode = false;
            state.editingAppDocId = null;
            window.scrollTo(0, 0);
            render();
        }

        // Toggle dark mode
        function toggleDarkMode() {
            state.isDarkMode = !state.isDarkMode;
            applyUserPreferences();
            
            // Save to user profile if logged in
            if (state.currentUser) {
                updateDoc(doc(db, 'users', state.currentUser.uid), {
                    darkMode: state.isDarkMode
                });
            } else {
                localStorage.setItem('theme', state.isDarkMode ? 'dark' : 'light');
            }
            
            render();
        }

        // Change language
        function changeLanguage(lang) {
            state.language = lang;
            applyUserPreferences();
            
            // Save to user profile if logged in
            if (state.currentUser) {
                updateDoc(doc(db, 'users', state.currentUser.uid), {
                    language: state.language
                });
            } else {
                localStorage.setItem('language', state.language);
            }
            
            render();
        }

        // Handle search
        function handleSearch(term) {
            state.searchTerm = term;
            state.selectedCategory = 'all';
            render();
        }

        // Handle category filter
        function handleCategoryFilter(category) {
            state.selectedCategory = category;
            state.searchTerm = '';
            render();
        }

        // Reset filters
        function resetFilters() {
            state.searchTerm = '';
            state.selectedCategory = 'all';
            render();
        }

        // Handle user registration
        async function handleRegister(email, password, displayName) {
            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                await updateProfile(userCredential.user, {
                    displayName: displayName
                });
                
                // Create user profile in Firestore
                await setDoc(doc(db, 'users', userCredential.user.uid), {
                    uid: userCredential.user.uid,
                    displayName: displayName,
                    email: email,
                    photoURL: 'https://ui-avatars.com/api/?name=' + encodeURIComponent(displayName) + '&background=8b5cf6&color=fff',
                    language: state.language,
                    darkMode: state.isDarkMode,
                    createdAt: new Date().toISOString()
                });
                
                return { success: true, message: t('registerSuccess') };
            } catch (error) {
                return { success: false, message: t('registerError') + ': ' + error.message };
            }
        }

        // Handle user login
        async function handleLogin(email, password) {
            try {
                await signInWithEmailAndPassword(auth, email, password);
                return { success: true, message: t('loginSuccess') };
            } catch (error) {
                return { success: false, message: t('loginError') + ': ' + error.message };
            }
        }

        // Handle user logout
        async function handleLogout() {
            try {
                await signOut(auth);
                navigate('home');
                return { success: true };
            } catch (error) {
                return { success: false, message: error.message };
            }
        }

        // Handle app submission
        async function handleAppSubmission(appData) {
            try {
                const appWithUserInfo = {
                    ...appData,
                    status: 'pending',
                    submitterId: state.currentUser.uid,
                    submitterName: state.userProfile.displayName,
                    submitterEmail: state.userProfile.email,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                await addDoc(collection(db, 'apps'), appWithUserInfo);
                return { success: true, message: t('submitSuccess') };
            } catch (error) {
                return { success: false, message: t('submitError') + ': ' + error.message };
            }
        }

        // Render functions would go here (similar to previous implementation but with translations)
        // For brevity, I'm including a simplified version of the render functions

        function renderHeader() {
            const categories = [t('all'), t('tools'), t('games'), t('social'), t('video'), t('music'), t('others')];
            
            return `
                <header class="glass-effect sticky top-0 z-50 rounded-3xl mb-6 py-4 shadow-lg">
                    <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                        <!-- Logo and App Name -->
                        <div class="flex items-center space-x-3 cursor-pointer" onclick="navigate('home')">
                            <div class="w-10 h-10 rounded-xl gradient-bg flex items-center justify-center">
                                <i class="fas fa-mobile-alt text-white"></i>
                            </div>
                            <h1 class="text-2xl font-bold gradient-text">${t('appName')}</h1>
                        </div>
                        
                        <!-- Search Bar -->
                        <div class="flex-1 max-w-2xl mx-4">
                            <div class="relative">
                                <input
                                    type="text"
                                    id="search-input"
                                    placeholder="${t('searchPlaceholder')}"
                                    value="${state.searchTerm}"
                                    oninput="handleSearch(this.value)"
                                    class="w-full py-3 px-4 pl-12 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-2xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 shadow-sm"
                                >
                                <div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                                    <i class="fas fa-search"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- User Actions -->
                        <div class="flex items-center space-x-4">
                            ${state.currentUser ? `
                                <!-- User Menu -->
                                <div class="relative group">
                                    <button class="flex items-center space-x-2 bg-white dark:bg-slate-800 py-2 px-4 rounded-2xl shadow-sm hover:shadow-md transition-all duration-300">
                                        <img src="${state.userProfile.photoURL}" alt="Profile" class="w-8 h-8 rounded-full">
                                        <span class="font-medium hidden sm:block">${state.userProfile.displayName}</span>
                                        <i class="fas fa-chevron-down text-gray-400"></i>
                                    </button>
                                    
                                    <!-- Dropdown Menu -->
                                    <div class="absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 rounded-2xl shadow-xl border border-gray-200 dark:border-slate-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
                                        <div class="p-4 border-b border-gray-100 dark:border-slate-700">
                                            <p class="font-semibold">${state.userProfile.displayName}</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">${state.userProfile.email}</p>
                                        </div>
                                        <div class="p-2">
                                            <button onclick="navigate('profile')" class="flex items-center space-x-3 w-full text-left py-2 px-3 rounded-xl hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors duration-200">
                                                <i class="fas fa-user text-purple-500 w-5"></i>
                                                <span>${t('profile')}</span>
                                            </button>
                                            <button onclick="navigate('my-apps')" class="flex items-center space-x-3 w-full text-left py-2 px-3 rounded-xl hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors duration-200">
                                                <i class="fas fa-box text-blue-500 w-5"></i>
                                                <span>${t('myApps')}</span>
                                            </button>
                                            ${state.isAdmin ? `
                                                <button onclick="navigate('admin')" class="flex items-center space-x-3 w-full text-left py-2 px-3 rounded-xl hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors duration-200">
                                                    <i class="fas fa-shield-alt text-red-500 w-5"></i>
                                                    <span>${t('adminPanel')}</span>
                                                </button>
                                            ` : ''}
                                            <button onclick="handleLogout()" class="flex items-center space-x-3 w-full text-left py-2 px-3 rounded-xl hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors duration-200 text-red-500">
                                                <i class="fas fa-sign-out-alt w-5"></i>
                                                <span>${t('logout')}</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ` : `
                                <!-- Login/Signup Buttons -->
                                <div class="flex space-x-3">
                                    <button onclick="navigate('login')" class="py-2 px-4 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-2xl font-medium hover:shadow-md transition-all duration-300">
                                        ${t('login')}
                                    </button>
                                    <button onclick="navigate('register')" class="py-2 px-4 gradient-bg text-white rounded-2xl font-medium hover:shadow-lg transition-all duration-300">
                                        ${t('signUp')}
                                    </button>
                                </div>
                            `}
                            
                            <!-- Dark Mode Toggle -->
                            <button onclick="toggleDarkMode()" class="p-3 bg-white dark:bg-slate-800 rounded-2xl shadow-sm hover:shadow-md transition-all duration-300">
                                ${state.isDarkMode ? 
                                    '<i class="fas fa-sun text-yellow-500"></i>' : 
                                    '<i class="fas fa-moon text-purple-500"></i>'
                                }
                            </button>
                        </div>
                    </div>
                    
                    <!-- Categories -->
                    ${state.currentView === 'home' ? `
                        <div class="max-w-7xl mx-auto px-4 mt-6">
                            <div class="flex flex-wrap gap-2 justify-center">
                                ${categories.map((cat, index) => `
                                    <button
                                        onclick="handleCategoryFilter('${index === 0 ? 'all' : cat.toLowerCase()}')"
                                        class="px-4 py-2 rounded-2xl font-medium transition-all duration-300 ${state.selectedCategory === (index === 0 ? 'all' : cat.toLowerCase()) ?
                                            'gradient-bg text-white shadow-lg transform scale-105' :
                                            'bg-white dark:bg-slate-800 text-gray-700 dark:text-gray-300 hover:shadow-md'
                                        }"
                                    >
                                        ${cat}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                </header>
            `;
        }

        function renderHomePage() {
            const filteredApps = state.approvedApps
                .filter(app => state.selectedCategory === 'all' || app.category === state.selectedCategory)
                .filter(app => app.name.toLowerCase().includes(state.searchTerm.toLowerCase()));
            
            const popularApps = [...state.approvedApps].sort((a, b) => (b.downloadCount || 0) - (a.downloadCount || 0)).slice(0, 6);
            const newApps = [...state.approvedApps].sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).slice(0, 6);
            
            return `
                ${renderHeader()}
                
                <main class="slide-in">
                    <!-- Hero Section -->
                    <section class="mb-12">
                        <div class="bg-gradient-to-r from-purple-500 to-cyan-500 rounded-3xl p-8 md:p-12 text-white shadow-2xl">
                            <div class="max-w-3xl">
                                <h1 class="text-4xl md:text-5xl font-bold mb-4">${t('welcome')} to ShareApp!</h1>
                                <p class="text-xl mb-8 opacity-90">Discover, share, and download amazing mobile applications from Myanmar developers.</p>
                                <div class="flex flex-wrap gap-4">
                                    <button onclick="navigate('explore')" class="py-3 px-6 bg-white text-purple-600 rounded-2xl font-bold hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                                        <i class="fas fa-rocket mr-2"></i> ${t('explore')}
                                    </button>
                                    ${state.currentUser ? `
                                        <button onclick="navigate('submit-app')" class="py-3 px-6 bg-transparent border-2 border-white text-white rounded-2xl font-bold hover:bg-white hover:text-purple-600 transition-all duration-300">
                                            <i class="fas fa-plus mr-2"></i> ${t('submitApp')}
                                        </button>
                                    ` : `
                                        <button onclick="navigate('register')" class="py-3 px-6 bg-transparent border-2 border-white text-white rounded-2xl font-bold hover:bg-white hover:text-purple-600 transition-all duration-300">
                                            <i class="fas fa-user-plus mr-2"></i> ${t('signUp')}
                                        </button>
                                    `}
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Popular Apps Section -->
                    <section class="mb-12">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-3xl font-bold gradient-text">${t('popularApps')}</h2>
                            <button onclick="navigate('explore')" class="text-purple-600 dark:text-purple-400 font-medium hover:underline">
                                ${t('seeAll')} <i class="fas fa-arrow-right ml-1"></i>
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${popularApps.length > 0 ? popularApps.map(app => `
                                <div class="app-card bg-white dark:bg-slate-800 rounded-3xl overflow-hidden">
                                    <div class="p-6">
                                        <div class="flex items-start space-x-4">
                                            <img src="${app.icon}" alt="${app.name}" class="w-16 h-16 rounded-2xl object-cover shadow-md">
                                            <div class="flex-1">
                                                <h3 class="font-bold text-lg mb-1">${app.name}</h3>
                                                <p class="text-sm text-cyan-600 dark:text-cyan-400 mb-2">${app.category}</p>
                                                <div class="flex items-center text-xs text-gray-500 dark:text-gray-400">
                                                    <span class="mr-3"><i class="fas fa-download mr-1"></i> ${app.downloadCount || 0}</span>
                                                    <span><i class="fas fa-star mr-1 text-yellow-500"></i> ${app.rating || 'N/A'}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mt-4 flex justify-between items-center">
                                            <span class="text-sm font-medium">${app.version}</span>
                                            <button onclick="navigate('details', '${app.id}')" class="py-2 px-4 bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-400 rounded-xl font-medium hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors duration-200">
                                                ${t('details')}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('') : `
                                <div class="col-span-3 text-center py-12">
                                    <i class="fas fa-box-open text-4xl text-gray-400 mb-4"></i>
                                    <p class="text-gray-500 dark:text-gray-400">${t('noAppsFound')}</p>
                                </div>
                            `}
                        </div>
                    </section>
                    
                    <!-- New Apps Section -->
                    <section class="mb-12">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-3xl font-bold gradient-text">${t('newApps')}</h2>
                            <button onclick="navigate('explore')" class="text-purple-600 dark:text-purple-400 font-medium hover:underline">
                                ${t('seeAll')} <i class="fas fa-arrow-right ml-1"></i>
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${newApps.length > 0 ? newApps.map(app => `
                                <div class="app-card bg-white dark:bg-slate-800 rounded-3xl overflow-hidden">
                                    <div class="p-6">
                                        <div class="flex items-start space-x-4">
                                            <img src="${app.icon}" alt="${app.name}" class="w-16 h-16 rounded-2xl object-cover shadow-md">
                                            <div class="flex-1">
                                                <h3 class="font-bold text-lg mb-1">${app.name}</h3>
                                                <p class="text-sm text-cyan-600 dark:text-cyan-400 mb-2">${app.category}</p>
                                                <div class="flex items-center text-xs text-gray-500 dark:text-gray-400">
                                                    <span class="mr-3"><i class="fas fa-calendar mr-1"></i> ${new Date(app.createdAt).toLocaleDateString()}</span>
                                                    <span><i class="fas fa-user mr-1"></i> ${app.developer}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mt-4 flex justify-between items-center">
                                            <span class="text-sm font-medium">${app.size}</span>
                                            <button onclick="navigate('details', '${app.id}')" class="py-2 px-4 bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-400 rounded-xl font-medium hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors duration-200">
                                                ${t('download')}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('') : `
                                <div class="col-span-3 text-center py-12">
                                    <i class="fas fa-box-open text-4xl text-gray-400 mb-4"></i>
                                    <p class="text-gray-500 dark:text-gray-400">${t('noAppsFound')}</p>
                                </div>
                            `}
                        </div>
                    </section>
                </main>
            `;
        }

        // Additional render functions for other views (profile, login, register, etc.)
        // Would be implemented similarly with translations and user-specific content

        // Main render function
        function render() {
            let content = '';
            
            switch (state.currentView) {
                case 'home':
                    content = renderHomePage();
                    break;
                case 'login':
                    content = renderLoginPage();
                    break;
                case 'register':
                    content = renderRegisterPage();
                    break;
                case 'profile':
                    content = renderProfilePage();
                    break;
                case 'my-apps':
                    content = renderMyAppsPage();
                    break;
                case 'submit-app':
                    content = renderSubmitAppPage();
                    break;
                case 'explore':
                    content = renderExplorePage();
                    break;
                case 'details':
                    content = renderAppDetailsPage();
                    break;
                case 'admin':
                    content = renderAdminPage();
                    break;
                default:
                    content = renderHomePage();
            }
            
            APP_CONTAINER.innerHTML = content;
            
            // Update FAB action based on current view
            updateFAB();
        }

        // Update Floating Action Button
        function updateFAB() {
            if (state.currentView === 'home' && state.currentUser) {
                FAB.innerHTML = '<i class="fas fa-plus"></i>';
                FAB.onclick = () => navigate('submit-app');
                FAB.classList.remove('hidden');
            } else if (state.currentView === 'explore' && state.currentUser) {
                FAB.innerHTML = '<i class="fas fa-plus"></i>';
                FAB.onclick = () => navigate('submit-app');
                FAB.classList.remove('hidden');
            } else if (state.currentView === 'my-apps') {
                FAB.innerHTML = '<i class="fas fa-plus"></i>';
                FAB.onclick = () => navigate('submit-app');
                FAB.classList.remove('hidden');
            } else {
                FAB.classList.add('hidden');
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);

        // Make functions globally available
        window.navigate = navigate;
        window.toggleDarkMode = toggleDarkMode;
        window.changeLanguage = changeLanguage;
        window.handleSearch = handleSearch;
        window.handleCategoryFilter = handleCategoryFilter;
        window.resetFilters = resetFilters;
        window.handleLogin = handleLogin;
        window.handleRegister = handleRegister;
        window.handleLogout = handleLogout;
        window.handleAppSubmission = handleAppSubmission;
    </script>
</body>
</html>
